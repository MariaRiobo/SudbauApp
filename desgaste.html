<!DOCTYPE h <a href="Corrosion.html" class="btn-volver"tml>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App Sudbau</title>
    <link rel="stylesheet" href="css/app.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">

</head>
<body>
    <div class="container">
        <div class="header-corrosion">
            <div class="header-left">
                <img src="img/logo.png" alt="Logo de la empresa" class="logo">

                <div class="titulo-y-tubo">
                <h1 class="title">DESGASTE</h1>
                <p class="subtitulo-tubo">Tubo NÂº <span id="numero-tubo"></span></p>
                </div>
            </div>
        </div>


        <div class="botones-container">
            <a href="tipo.html" class="btn-color amarillo">Amarillo</a>
            <a href="tipo.html" class="btn-color azul">Azul</a>
            <a href="tipo.html" class="btn-color verde">Verde</a>
            <a href="tipo.html" class="btn-color rojo">Rojo</a>
            <a href="tipo.html" class="btn-color blanco">Blanco</a>
        </div>
        

        <div class="controles">
            <a href="Corrosion.html" class="btn-volver">Volver</a>
        </div>

        

    </div>

<script>
  /* ========= Helpers mÃ­nimos de storage ========= */
  function loadIntervencion() {
    const raw = localStorage.getItem('intervencionActual');
    if (!raw) { window.location.href = 'InicioSesion.html'; return null; }
    const itv = JSON.parse(raw);
    if (!itv.draft) itv.draft = {};       // borrador del tubo actual
    if (!itv.eventos) itv.eventos = [];   // log de eventos (opcional)
    return itv;
  }
  function saveIntervencion(itv){
    localStorage.setItem('intervencionActual', JSON.stringify(itv));
  }
  // ðŸ‘‰ Igual que en CorrosiÃ³n: guardamos una traza con timestamp
  function pushEvento(tipo, extra = {}) {
    const itv = loadIntervencion(); if (!itv) return;
    itv.eventos.push({
      tipo, tubo: Number(itv.tuboActual),
      at: new Date().toISOString(),
      ...extra
    });
    saveIntervencion(itv);
  }

  /* ========= Estado inicial: nÃºmero de tubo ========= */
  const itv = loadIntervencion();
  if (itv) {
    const numeroTuboSpan = document.getElementById('numero-tubo');
    if (numeroTuboSpan) numeroTuboSpan.textContent = itv.tuboActual;
  }

  /* ========= Guardar selecciÃ³n de DESGASTE y navegar ========= */
  document.querySelectorAll('.botones-container .btn-color').forEach(a => {
    a.addEventListener('click', (e) => {
      e.preventDefault();

      // detectar color por clase (amarillo/azul/verde/rojo/blanco)
      const clases = e.currentTarget.className.split(/\s+/);
      const color = ['amarillo','azul','verde','rojo','blanco']
        .find(c => clases.includes(c)) || 'desconocido';

      const itv2 = loadIntervencion(); if (!itv2) return;
      itv2.draft.desgasteColor = color;   // âœ… queda en draft
      saveIntervencion(itv2);

      // âœ… traza en eventos (asÃ­ lo ves como en corrosiÃ³n)
      pushEvento('desgasteSeleccionado', { color });

      // navegar a Tipo
      window.location.href = e.currentTarget.getAttribute('href'); // tipo.html
    });
  });
</script>

</body>
</html>
